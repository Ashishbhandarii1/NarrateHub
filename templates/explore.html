{% extends 'base.html' %}

{% block title %}Explore | ARG-Listener{% endblock %}

{% block content %}
<div class="container">
    <div class="hero-section" style="padding: 40px 0; text-align: left;">
        <h1>Explore the Database</h1>
        
        <form action="{{ url_for('explore') }}" method="GET" style="display: flex; gap: 10px; max-width: 600px; margin-top: 20px;">
            <input type="text" name="search" placeholder="Search titles, tags, or content..." value="{{ search_term }}" style="margin-bottom: 0;">
            <select name="category" style="width: 150px; margin-bottom: 0;">
                <option value="">All Types</option>
                {% for cat_code, cat_name in category_names.items() %}
                <option value="{{ cat_code }}" {% if current_category == cat_code %}selected{% endif %}>{{ cat_name }}</option>
                {% endfor %}
            </select>
            <button type="submit" class="btn"><i class="fas fa-search"></i></button>
        </form>
    </div>

    <div style="margin-bottom: 30px;">
        <span style="color: var(--text-muted); margin-right: 10px;">Popular Tags:</span>
        {% for t in popular_tags %}
            <a href="{{ url_for('explore', tag=t) }}" class="tag" style="display: inline-block; background: #222; border: 1px solid var(--border); padding: 5px 10px; margin: 0 5px 5px 0; border-radius: 4px; font-size: 0.8rem; color: var(--text-white);">#{{ t }}</a>
        {% endfor %}
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 30px;">
        {% for item in content %}
        <div class="content-card">
            {% if item.image_url %}
                <img src="{{ item.image_url }}" alt="{{ item.title }}" class="content-image" style="height: 180px;">
            {% endif %}
            
            <h3>{{ item.title }}</h3>
            
            <div class="content-meta">
                <span><i class="fas fa-scroll"></i> {{ category_names[item.category] }}</span>
                <span><i class="fas fa-globe"></i> {{ item.language }}</span>
            </div>
            
            <p style="color: var(--text-muted); font-size: 0.95rem; margin-bottom: 15px;">
                {{ item.get_preview(100) }}
            </p>
            
            <a href="{{ url_for('content_detail', content_id=item.id) }}" class="btn btn-secondary" style="width: 100%; text-align: center;">View Scroll</a>
        </div>
        {% else %}
        <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: var(--text-muted);">
            <h2>No scrolls found matching your criteria.</h2>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}